import{a as P,r as i,j as e,B as l,K as g,T as c,a4 as N,a2 as y,g as L,b as k,C as $,N as B,Q as D,U as m,V as a,W as R,k as _,o as z,c as b,X as H,Y as M,Z as F,A as U}from"./index-C-AtCVLN.js";import{S as W}from"./Search-B53zclG-.js";const V="https://api.bookmyevent.ae/api/profile";function X(){const w=P(),[j,C]=i.useState(0),[A,p]=i.useState([]),[d,T]=i.useState(""),[v,f]=i.useState(!0),[h,o]=i.useState({open:!1,message:"",severity:"success"}),S=async()=>{try{f(!0);const n=await(await fetch(`${V}/vendors/all`)).json();if(!n.success)throw new Error(n.message);const t=n.data.filter(r=>r.user&&r.user._id).map((r,x)=>({id:x+1,vendorId:r.user._id,name:`${r.user.firstName||""} ${r.user.lastName||""}`.trim()||"N/A",email:r.user.email||"N/A",phone:r.user.phone||"N/A",isVerified:r.isVerified||!1,status:r.isVerified?"Verified":"Pending"}));p(t)}catch(s){o({open:!0,message:s.message,severity:"error"})}finally{f(!1)}};i.useEffect(()=>{S()},[]);const I=async(s,n)=>{if(!s){o({open:!0,message:"Vendor ID missing. Cannot delete.",severity:"error"});return}if(window.confirm(`Are you sure you want to delete "${n}"?`))try{const r=await(await fetch(`${V}/vendor/${s}`,{method:"DELETE"})).json();if(!r.success)throw new Error(r.message);p(x=>x.filter(E=>E.vendorId!==s)),o({open:!0,message:"Vendor deleted successfully",severity:"success"})}catch(t){o({open:!0,message:t.message,severity:"error"})}},u=A.filter(s=>{const n=j===0?!s.isVerified:s.isVerified,t=s.name.toLowerCase().includes(d.toLowerCase())||s.email.toLowerCase().includes(d.toLowerCase());return n&&t});return e.jsxs(l,{p:3,bgcolor:"#f4f6f8",minHeight:"100vh",children:[e.jsxs(g,{sx:{p:3,mb:3,borderRadius:2},children:[e.jsx(c,{variant:"h5",fontWeight:600,children:"Providers List"}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Manage catering vendors"})]}),e.jsxs(g,{sx:{borderRadius:2},children:[e.jsxs(N,{value:j,onChange:(s,n)=>C(n),children:[e.jsx(y,{label:"Pending Vendors"}),e.jsx(y,{label:"Verified Vendors"})]}),e.jsxs(l,{p:3,children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,gap:2,children:[e.jsxs(c,{variant:"h6",children:["Vendors (",u.length,")"]}),e.jsx(L,{size:"small",placeholder:"Search vendor or email",value:d,onChange:s=>T(s.target.value),InputProps:{startAdornment:e.jsx(k,{position:"start",children:e.jsx(W,{})})}})]}),v?e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx($,{size:22}),e.jsx(c,{children:"Loading vendors..."})]}):e.jsxs(B,{children:[e.jsx(D,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Vendor"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Phone"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Actions"})]})}),e.jsxs(R,{children:[u.map(s=>e.jsxs(m,{hover:!0,children:[e.jsx(a,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(_,{children:s.name.charAt(0).toUpperCase()}),e.jsx(c,{children:s.name})]})}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.phone}),e.jsx(a,{children:e.jsx(z,{label:s.status,size:"small",color:s.isVerified?"success":"warning"})}),e.jsxs(a,{align:"center",children:[e.jsx(b,{color:"primary",onClick:()=>w(`/makeup/AddProvider/${s.vendorId}`),children:e.jsx(H,{})}),e.jsx(b,{color:"error",onClick:()=>I(s.vendorId,s.name),children:e.jsx(M,{})})]})]},s.vendorId)),u.length===0&&e.jsx(m,{children:e.jsx(a,{colSpan:5,align:"center",children:"No Vendors Found"})})]})]})]})]}),e.jsx(F,{open:h.open,autoHideDuration:4e3,onClose:()=>o(s=>({...s,open:!1})),children:e.jsx(U,{severity:h.severity,variant:"filled",children:h.message})})]})}export{X as default};
