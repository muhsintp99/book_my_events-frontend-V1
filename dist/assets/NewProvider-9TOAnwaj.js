import{a as L,r as o,j as e,B as l,T as c,K as b,a4 as U,a2 as v,g as R,b as _,C as $,N as B,Q as D,U as m,V as t,W as H,k as z,o as F,c as y,X as W,Y as G,Z as K,A as M}from"./index-CXSvRfrP.js";import{S as O}from"./Search-CWf_i7h6.js";function Y({isVerified:T}){const w=L(),[f,C]=o.useState(0),[A,S]=o.useState([]),[h,P]=o.useState(""),[V,g]=o.useState(!0),[x,u]=o.useState({open:!1,message:"",severity:"error"}),I=(s,r)=>{C(r)},N=()=>({method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors"}),k=async(s,r,i=2)=>{for(let a=0;a<=i;a++)try{const n=new AbortController,j=setTimeout(()=>n.abort(),1e4),d=await fetch(s,{...r,signal:n.signal});if(clearTimeout(j),!d.ok){const E=await d.text();throw new Error(E||`HTTP ${d.status}`)}return await d.json()}catch(n){if(a<i){await new Promise(j=>setTimeout(j,1e3));continue}throw n}};o.useEffect(()=>{(async()=>{try{g(!0);const r=await k("https://api.bookmyevent.ae/api/users",N());if(Array.isArray(r.users)){const i=r.users.map((a,n)=>({id:n+1,_id:a._id,name:`${a.firstName||""} ${a.lastName||""}`.trim(),email:a.email||"N/A",role:a.role||"N/A",phone:a.phone||a.mobile||"N/A",isVerified:a.isVerified||!1,status:a.isVerified?"Verified":"Pending"}));S(i)}else throw new Error("Unexpected data format")}catch(r){u({open:!0,message:r.message,severity:"error"})}finally{g(!1)}})()},[]);const p=A.filter(s=>{const r=f===0?!s.isVerified:s.isVerified,i=s.name.toLowerCase().includes(h.toLowerCase())||s.email.toLowerCase().includes(h.toLowerCase());return r&&i});return T?e.jsx(l,{p:3,display:"flex",justifyContent:"center",children:e.jsx(c,{variant:"h6",children:"Provider is verified"})}):e.jsxs(l,{p:3,bgcolor:"#f4f6f8",minHeight:"100vh",children:[e.jsxs(b,{sx:{p:3,mb:3,borderRadius:2},children:[e.jsx(c,{variant:"h5",fontWeight:600,children:"Providers List"}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Manage providers with edit & delete options"})]}),e.jsxs(b,{sx:{borderRadius:2},children:[e.jsxs(U,{value:f,onChange:I,children:[e.jsx(v,{label:"Pending Stores"}),e.jsx(v,{label:"Verified Stores"})]}),e.jsxs(l,{p:3,children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,gap:2,children:[e.jsxs(c,{variant:"h6",children:["Stores (",p.length,")"]}),e.jsx(R,{size:"small",placeholder:"Search user or email",value:h,onChange:s=>P(s.target.value),InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(O,{})})}})]}),V?e.jsxs(l,{display:"flex",gap:2,children:[e.jsx($,{size:22}),e.jsx(c,{children:"Loading users..."})]}):e.jsxs(B,{children:[e.jsx(D,{children:e.jsxs(m,{children:[e.jsx(t,{children:"User"}),e.jsx(t,{children:"Role"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Phone"}),e.jsx(t,{children:"Status"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsxs(H,{children:[p.map(s=>e.jsxs(m,{hover:!0,children:[e.jsx(t,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(z,{children:s.name.charAt(0)}),e.jsx(c,{children:s.name})]})}),e.jsx(t,{children:s.role}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.phone}),e.jsx(t,{children:e.jsx(F,{label:s.status,size:"small",color:s.isVerified?"success":"warning"})}),e.jsxs(t,{align:"center",children:[e.jsx(y,{color:"primary",onClick:()=>w(`/makeup/AddProvider/${s._id}`),children:e.jsx(W,{})}),e.jsx(y,{color:"error",onClick:()=>alert(`Delete provider: ${s.name}`),children:e.jsx(G,{})})]})]},s._id)),p.length===0&&e.jsx(m,{children:e.jsx(t,{colSpan:6,align:"center",children:"No Data Found"})})]})]})]})]}),e.jsx(K,{open:x.open,autoHideDuration:4e3,onClose:()=>u(s=>({...s,open:!1})),children:e.jsx(M,{severity:x.severity,variant:"filled",children:x.message})})]})}export{Y as default};
