import{r as h,j as s,B as l,T as u,g as C,b as S,G as j,q as W,o as P,m as I,a3 as E,Z as U,A}from"./index-D781LPqD.js";import{S as M}from"./Search-QpPOBNxK.js";import{C as R}from"./CardMedia-PVu7Mm-H.js";const r="https://api.bookmyevent.ae/api";function B(){const[d,w]=h.useState(""),[k,x]=h.useState([]),[b,p]=h.useState(!1),[c,g]=h.useState({open:!1,message:"",severity:"success"});h.useEffect(()=>{T(),d&&$()},[d]);const T=async()=>{p(!0);try{const t=await fetch(`${r}/venues?_t=${new Date().getTime()}`,{method:"GET",headers:{"Content-Type":"application/json"}}),o=await t.json();if(console.log("Venues Response:",o),t.ok&&o.data){const i=o.data.map(a=>{let e=a.thumbnail||"";if(e&&!(e.startsWith("http://")||e.startsWith("https://")))if(e.includes("/Uploads/")){const n=e.indexOf("/Uploads/"),m=e.substring(n);e=`${r}${m}`}else if(e.startsWith("Uploads/"))e=`${r}/${e}`;else if(e.startsWith("/uploads")||e.startsWith("uploads")){const n=e.startsWith("/")?e:`/${e}`;e=`${r}${n}`}else e=`${r}/${e}`;return console.log("Venue image processing:",{id:a._id,original:a.thumbnail,final:e}),{...a,thumbnail:e,isTopPick:a.isTopPick||!1}});x(i)}else f("Failed to fetch venues","error")}catch(t){console.error("Error fetching venues:",t),f("Error fetching venues: "+t.message,"error")}finally{p(!1)}},$=async()=>{p(!0);try{const t=await fetch(`${r}/venues/search?keyword=${d}&_t=${new Date().getTime()}`,{method:"GET",headers:{"Content-Type":"application/json"}}),o=await t.json();if(console.log("Search Response:",o),t.ok&&o.data){const i=o.data.map(a=>{let e=a.thumbnail||"";if(e&&!(e.startsWith("http://")||e.startsWith("https://")))if(e.includes("/Uploads/")){const n=e.indexOf("/Uploads/"),m=e.substring(n);e=`${r}${m}`}else if(e.startsWith("Uploads/"))e=`${r}/${e}`;else if(e.startsWith("/uploads")||e.startsWith("uploads")){const n=e.startsWith("/")?e:`/${e}`;e=`${r}${n}`}else e=`${r}/${e}`;return{...a,thumbnail:e,isTopPick:a.isTopPick||!1}});x(i)}else f("Failed to search venues","error")}catch(t){console.error("Error searching venues:",t),f("Error searching venues: "+t.message,"error")}finally{p(!1)}},f=(t,o="success")=>{g({open:!0,message:t,severity:o})},v=t=>{x(o=>o.map(i=>i._id===t?{...i,isTopPick:!i.isTopPick}:i))},y=k;return s.jsxs(l,{sx:{minHeight:"100vh",p:{xs:2,sm:4},bgcolor:"#f0f2f5"},children:[s.jsxs(l,{sx:{textAlign:"center",mb:6},children:[s.jsx(u,{variant:"h3",fontWeight:"bold",sx:{background:"linear-gradient(90deg,#1565c0,#42a5f5)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:"Top Picks"}),s.jsx(u,{variant:"body1",color:"text.secondary",children:"Highlight your top venues with style"}),s.jsx(C,{placeholder:"Search venues by name or ID...",value:d,onChange:t=>w(t.target.value),variant:"outlined",fullWidth:!0,sx:{maxWidth:450,mt:3,borderRadius:3,backgroundColor:"#fff","& .MuiOutlinedInput-root":{borderRadius:3}},InputProps:{startAdornment:s.jsx(S,{position:"start",children:s.jsx(M,{color:"action"})})}})]}),s.jsxs(j,{container:!0,spacing:4,justifyContent:"center",children:[b&&s.jsx("p",{children:"Loading..."}),y.map(t=>s.jsx(j,{item:!0,xs:12,sm:6,md:4,children:s.jsxs(W,{sx:{borderRadius:4,overflow:"hidden",position:"relative",cursor:"pointer",transition:"transform 0.4s, box-shadow 0.4s",boxShadow:t.isTopPick?"0 10px 20px rgba(21,101,192,0.25)":"0 4px 12px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-10px)",boxShadow:"0 14px 30px rgba(0,0,0,0.15)"}},children:[s.jsxs(l,{sx:{position:"relative",height:220,"&:after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",bgcolor:"rgba(0,0,0,0.25)",transition:"background 0.3s",zIndex:1},"&:hover:after":{bgcolor:"rgba(0,0,0,0.15)"}},children:[s.jsx(l,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:t.thumbnail?s.jsx(R,{component:"img",height:"220",image:t.thumbnail,alt:t.venueName,sx:{objectFit:"cover",width:"100%"},onError:o=>{console.error("Image load error for URL:",t.thumbnail),o.target.style.display="none";const i=o.target.parentElement;i&&(i.innerHTML='<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#f5f5f5;color:#999;font-size:0.9rem;">No Image</div>')}}):s.jsx(l,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#f5f5f5",color:"#999",fontSize:"0.9rem"},children:"No Image"})}),t.isTopPick&&s.jsx(P,{label:"Top Pick",color:"primary",sx:{position:"absolute",top:12,left:12,fontWeight:600,px:1.5,py:.5,transform:"translateY(-2px)",zIndex:2}})]}),s.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:2,py:1.5,bgcolor:"#fff"},children:[s.jsx(u,{variant:"subtitle1",fontWeight:600,sx:{flex:1,pr:2,color:"#2c3e50",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.venueName}),s.jsx(E,{checked:t.isTopPick||!1,onChange:()=>v(t._id),color:"primary",sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#1976d2"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#90caf9"}}})]})]})},t._id)),y.length===0&&!b&&s.jsx(l,{sx:{textAlign:"center",mt:10},children:s.jsx(u,{variant:"body1",color:"text.secondary",children:"No venues found."})})]}),s.jsx(U,{open:c.open,autoHideDuration:6e3,onClose:()=>g({...c,open:!1}),anchorOrigin:{vertical:"top",horizontal:"right"},children:s.jsx(A,{onClose:()=>g({...c,open:!1}),severity:c.severity,sx:{width:"100%"},variant:"filled",children:c.message})})]})}export{B as default};
