import{a as L,r as i,j as e,B as n,T as o,K as y,a4 as U,a2 as v,g as $,b as R,C as _,N as B,Q as D,U as m,V as a,W as H,k as z,o as F,c as T,X as M,Y as O,Z as W,A as G}from"./index-CgvkLXhQ.js";import{S as J}from"./Search-DS6UMqv3.js";function X({isVerified:w}){const C=L(),[x,S]=i.useState(0),[u,A]=i.useState([]),[c,I]=i.useState(""),[P,g]=i.useState(!0),[j,b]=i.useState({open:!1,message:"",severity:"error"}),V=(s,t)=>{S(t)},N=(s="GET",t=null)=>{const r={method:s,headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors"};return t&&(r.body=JSON.stringify(t)),r},k=async(s,t,r=2)=>{for(let l=0;l<=r;l++)try{const d=new AbortController,p=setTimeout(()=>d.abort(),1e4),h=await fetch(s,{...t,signal:d.signal});if(clearTimeout(p),!h.ok){const E=await h.text();throw new Error(`HTTP ${h.status}: ${E}`)}return await h.json()}catch(d){if(l<r){await new Promise(p=>setTimeout(p,1e3));continue}throw d}};i.useEffect(()=>{(async()=>{try{g(!0);const t=await k("https://api.bookmyevent.ae/api/users",N());if(Array.isArray(t.users))A(t.users.map((r,l)=>({id:l+1,_id:r._id,userInfo:`${r.firstName||""} ${r.lastName||""}`.trim(),email:r.email||"N/A",role:r.role||"N/A",isVerified:r.isVerified||!1,status:r.isVerified?"Verified":"Pending"})));else throw new Error("Unexpected data format")}catch(t){b({open:!0,message:t.message,severity:"error"})}finally{g(!1)}})()},[]);const f=i.useMemo(()=>u.filter(s=>{const t=x===0?!s.isVerified:s.isVerified,r=s.userInfo.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase());return t&&r}),[u,x,c]);return w?e.jsx(n,{p:3,display:"flex",justifyContent:"center",children:e.jsx(o,{variant:"h6",children:"Provider is verified"})}):e.jsxs(n,{p:3,bgcolor:"#f4f6f8",minHeight:"100vh",children:[e.jsxs(y,{sx:{p:3,mb:3,borderRadius:2},children:[e.jsx(o,{variant:"h5",fontWeight:600,children:"Providers List"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Manage providers with edit & delete actions"})]}),e.jsxs(y,{sx:{borderRadius:2},children:[e.jsxs(U,{value:x,onChange:V,children:[e.jsx(v,{label:"Pending Stores"}),e.jsx(v,{label:"Verified Stores"})]}),e.jsxs(n,{p:3,children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:2,gap:2,children:[e.jsxs(o,{variant:"h6",children:["Stores (",f.length,")"]}),e.jsx($,{size:"small",placeholder:"Search user or email",value:c,onChange:s=>I(s.target.value),InputProps:{startAdornment:e.jsx(R,{position:"start",children:e.jsx(J,{})})}})]}),P?e.jsxs(n,{display:"flex",gap:2,children:[e.jsx(_,{size:22}),e.jsx(o,{children:"Loading users..."})]}):e.jsxs(B,{children:[e.jsx(D,{children:e.jsxs(m,{children:[e.jsx(a,{children:"User"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Actions"})]})}),e.jsxs(H,{children:[f.map(s=>e.jsxs(m,{hover:!0,children:[e.jsx(a,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(z,{children:s.userInfo.charAt(0)}),e.jsx(o,{children:s.userInfo})]})}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.email}),e.jsx(a,{children:e.jsx(F,{label:s.status,size:"small",color:s.isVerified?"success":"warning"})}),e.jsxs(a,{align:"center",children:[e.jsx(T,{color:"primary",onClick:()=>C(`/makeup/AddProvider/${s._id}`),children:e.jsx(M,{})}),e.jsx(T,{color:"error",onClick:()=>alert(`Delete ${s.userInfo}`),children:e.jsx(O,{})})]})]},s._id)),f.length===0&&e.jsx(m,{children:e.jsx(a,{colSpan:5,align:"center",children:"No Data Found"})})]})]})]})]}),e.jsx(W,{open:j.open,autoHideDuration:4e3,onClose:()=>b(s=>({...s,open:!1})),children:e.jsx(G,{severity:j.severity,variant:"filled",children:j.message})})]})}export{X as default};
