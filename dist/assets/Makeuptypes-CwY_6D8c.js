import{a as ce,u as de,e as he,r,j as e,B as g,q as U,m as _,T as C,g as N,d as x,C as M,o as pe,b as xe,l as ue,M as F,a7 as P,a8 as V,D as me,J as fe,K as je,N as ye,Q as ge,U as S,V as h,W as ke,S as be,c as H,X as we,Y as Ce,_ as J,$ as Q,a0 as X,a1 as q,Z as Se,A as Ee}from"./index-CgvkLXhQ.js";import{S as ve}from"./Search-DS6UMqv3.js";import{E as Te}from"./ExpandMore-hDX_ElcU.js";import{E as Ie}from"./FileDownload-tD0lsIHS.js";import{E as De}from"./TableView-DDvE5aaM.js";import{C as Ae}from"./Description-BlVNf_SV.js";const E="https://api.bookmyevent.ae/api",v={list:"/makeup-types",create:"/makeup-types",delete:i=>`/makeup-types/${i}`,update:i=>`/makeup-types/${i}`};function Re(){const i=ce(),K=de(),Y=he(K.breakpoints.down("sm")),[T,I]=r.useState(""),[Z,O]=r.useState([]),[u,l]=r.useState(!0),[D,G]=r.useState(""),[A,$]=r.useState({open:!1,message:"",severity:"success"}),[L,k]=r.useState({open:!1,id:null,name:""}),[ee,R]=r.useState(!1),[m,W]=r.useState(null),[B,b]=r.useState(null),te=!!B,w=()=>localStorage.getItem("token")||sessionStorage.getItem("token"),o=(t,s="success")=>{$({open:!0,message:t,severity:s})},f=r.useCallback(async()=>{const t=w();if(!t){O([]),l(!1);return}l(!0);try{const s=await fetch(`${E}${v.list}`,{headers:{Authorization:`Bearer ${t}`}});if(s.status===401){i("/login");return}if(!s.ok)throw new Error("Failed to fetch makeup types");const n=await s.json(),a=n.data||n.makeupTypes||[];O(Array.isArray(a)?a:[])}catch(s){console.error("fetchTypes error:",s),o("Failed to fetch makeup types","error")}finally{l(!1)}},[i]);r.useEffect(()=>{f()},[f]);const se=async()=>{const t=w();if(!t)return i("/login");const s=(T||"").trim();if(!s)return o("Please enter a type name","error");l(!0);try{const n=await fetch(`${E}${v.create}`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:s})});if(!n.ok){const c=await n.text();throw new Error(c||"Failed to create type")}const a=await n.json();o(a.message||"Created successfully","success"),I(""),f()}catch(n){console.error("create error:",n),o(n.message||"Failed to create type","error")}finally{l(!1)}},ne=t=>{k({open:!0,id:t._id,name:t.name})},ae=async()=>{const t=w();if(!t)return i("/login");l(!0);try{const s=await fetch(`${E}${v.delete(L.id)}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(!s.ok){const a=await s.text();throw new Error(a||"Delete failed")}const n=await s.json();o(n.message||"Deleted successfully","success"),k({open:!1,id:null,name:""}),f()}catch(s){console.error("delete error:",s),o(s.message||"Failed to delete","error")}finally{l(!1)}},oe=t=>{W({...t}),R(!0)},z=()=>{R(!1),W(null)},re=async()=>{if(!m)return;const t=w();if(!t)return i("/login");const s=(m.name||"").trim();if(!s)return o("Enter a name","error");l(!0);try{const n=await fetch(`${E}${v.update(m._id)}`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:s})});if(!n.ok){const c=await n.text();throw new Error(c||"Update failed")}const a=await n.json();o(a.message||"Updated successfully","success"),z(),f()}catch(n){console.error("edit save error:",n),o(n.message||"Failed to update","error")}finally{l(!1)}},ie=()=>{const t=["SI","ID","Name"],s=j.map((d,y)=>[y+1,d._id,d.name]);let n=t.join(",")+`
`;s.forEach(d=>{n+=d.map(y=>`"${String(y).replace(/"/g,'""')}"`).join(",")+`
`});const a=new Blob([n],{type:"text/csv"}),c=URL.createObjectURL(a),p=document.createElement("a");p.href=c,p.download=`makeup_types_${new Date().toISOString().slice(0,10)}.csv`,p.click(),URL.revokeObjectURL(c),b(null),o("CSV downloaded","success")},le=()=>{const t=["SI","ID","Name"],s=j.map((d,y)=>[y+1,d._id,d.name]);let n=t.join("	")+`
`;s.forEach(d=>{n+=d.join("	")+`
`});const a=new Blob([n],{type:"application/vnd.ms-excel"}),c=URL.createObjectURL(a),p=document.createElement("a");p.href=c,p.download=`makeup_types_${new Date().toISOString().slice(0,10)}.xls`,p.click(),URL.revokeObjectURL(c),b(null),o("Excel downloaded","success")},j=Z.filter(t=>(t.name||"").toLowerCase().includes((D||"").toLowerCase()));return e.jsxs(g,{sx:{width:"100%",minHeight:"100vh",background:"#f5f5f5",p:3},children:[e.jsx(U,{sx:{maxWidth:1200,mx:"auto",mb:4,borderRadius:3,boxShadow:3},children:e.jsxs(_,{children:[e.jsx(C,{variant:"h6",fontWeight:600,sx:{mb:3},children:"Create Makeup Type"}),e.jsxs(C,{sx:{mb:1,fontWeight:500},children:["Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(N,{fullWidth:!0,value:T,onChange:t=>I(t.target.value),sx:{mb:3},placeholder:"Enter type name",disabled:u}),e.jsxs(g,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(x,{variant:"outlined",onClick:()=>I(""),disabled:u,children:"Reset"}),e.jsx(x,{variant:"contained",onClick:se,disabled:!T.trim()||u,children:u?e.jsx(M,{size:18,color:"inherit"}):"Add"})]})]})}),e.jsx(U,{sx:{maxWidth:1200,mx:"auto",borderRadius:3,boxShadow:3},children:e.jsxs(_,{children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",mb:3,flexWrap:"wrap",gap:2},children:[e.jsxs(C,{variant:"h6",fontWeight:600,children:["Makeup Type List ",e.jsx(pe,{label:j.length,size:"small",sx:{ml:1}})]}),e.jsxs(g,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(N,{size:"small",placeholder:"Search...",value:D,onChange:t=>G(t.target.value),InputProps:{startAdornment:e.jsx(xe,{position:"start",children:e.jsx(ve,{})})},sx:{minWidth:220},disabled:u}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(Ie,{}),endIcon:e.jsx(Te,{}),onClick:t=>b(t.currentTarget),children:"Export"})]})]}),e.jsxs(ue,{anchorEl:B,open:te,onClose:()=>b(null),children:[e.jsxs(F,{onClick:le,children:[e.jsx(P,{children:e.jsx(De,{fontSize:"small"})}),e.jsx(V,{children:"Export to Excel"})]}),e.jsx(me,{}),e.jsxs(F,{onClick:ie,children:[e.jsx(P,{children:e.jsx(Ae,{fontSize:"small"})}),e.jsx(V,{children:"Export to CSV"})]})]}),e.jsx(fe,{component:je,sx:{mt:2},children:e.jsxs(ye,{size:"small",sx:{tableLayout:"fixed"},children:[e.jsx(ge,{children:e.jsxs(S,{sx:{height:56},children:[e.jsx(h,{sx:{width:"8%",fontWeight:700,background:"#fafafa"},children:"SI"}),e.jsx(h,{sx:{width:"64%",fontWeight:700,background:"#fafafa"},children:"Name"}),e.jsx(h,{sx:{width:"28%",fontWeight:700,background:"#fafafa"},children:"Action"})]})}),e.jsx(ke,{children:u?e.jsx(S,{children:e.jsx(h,{colSpan:3,align:"center",sx:{py:6},children:e.jsx(M,{})})}):j.length===0?e.jsx(S,{children:e.jsx(h,{colSpan:3,align:"center",sx:{py:6,color:"#777"},children:D?"No types match your search.":"No makeup types found. Create one above."})}):j.map((t,s)=>e.jsxs(S,{hover:!0,sx:{height:64},children:[e.jsx(h,{children:s+1}),e.jsx(h,{sx:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsx(C,{variant:"body2",fontWeight:500,children:t.name})}),e.jsx(h,{children:e.jsxs(be,{direction:"row",spacing:1,children:[e.jsx(H,{size:"small",onClick:()=>oe(t),children:e.jsx(we,{fontSize:"small"})}),e.jsx(H,{size:"small",color:"error",onClick:()=>ne(t),children:e.jsx(Ce,{fontSize:"small"})})]})})]},t._id))})]})})]})}),e.jsxs(J,{open:L.open,onClose:()=>k({open:!1,id:null,name:""}),children:[e.jsx(Q,{children:"Delete Makeup Type"}),e.jsxs(X,{children:["Are you sure you want to delete ",e.jsx("strong",{children:L.name}),"?"]}),e.jsxs(q,{children:[e.jsx(x,{onClick:()=>k({open:!1,id:null,name:""}),children:"Cancel"}),e.jsx(x,{color:"error",variant:"contained",onClick:ae,children:"Delete"})]})]}),e.jsxs(J,{open:ee,onClose:z,fullWidth:!0,maxWidth:"sm",fullScreen:Y,"aria-labelledby":"edit-makeup-type",children:[e.jsx(Q,{id:"edit-makeup-type",children:"Edit Makeup Type"}),e.jsx(X,{children:e.jsx(g,{sx:{mt:1},children:e.jsx(N,{fullWidth:!0,label:"Name",value:m?.name||"",onChange:t=>W(s=>({...s,name:t.target.value})),placeholder:"Enter type name",autoFocus:!0})})}),e.jsxs(q,{sx:{px:3,py:2},children:[e.jsx(x,{onClick:z,children:"Cancel"}),e.jsx(x,{variant:"contained",onClick:re,disabled:!m?.name?.trim(),children:"Save"})]})]}),e.jsx(Se,{open:A.open,autoHideDuration:4e3,onClose:()=>$(t=>({...t,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ee,{severity:A.severity,onClose:()=>$(t=>({...t,open:!1})),sx:{width:"100%"},children:A.message})})]})}export{Re as default};
