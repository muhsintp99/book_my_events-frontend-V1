import{r as g,a as Re,j as e,B as b,S as _,C as H,T as C,Z as he,A as me,d as k,q as xe,m as pe,a4 as Fe,a2 as Ue,g as Y,M as I,c as re,a6 as Oe,o as fe,b as Be,l as _e,a7 as ye,a8 as be,D as He,J as Ye,K as Je,N as Ve,Q as Ge,U as ae,V as v,W as qe,a3 as Ke,X as Xe,Y as Qe,_ as Ze,$ as et,a0 as tt,a1 as rt}from"./index-D781LPqD.js";import{C as at}from"./CloudUpload-DIPcQBXH.js";import{S as ot}from"./Search-QpPOBNxK.js";import{E as st}from"./ExpandMore-j6dzDF55.js";import{E as nt}from"./FileDownload-B_lnBiKu.js";import{E as it}from"./TableView-DBYehj7c.js";import{C as lt}from"./Description-UmF_S9X5.js";const z="https://api.bookmyevent.ae/api";function pt(){const[f,je]=g.useState(0),[$,Ce]=g.useState(""),[R,J]=g.useState(null),[oe,V]=g.useState(null),[A,ve]=g.useState([]),[T,G]=g.useState(!0),[j,E]=g.useState(null),[q,K]=g.useState("all"),[c,F]=g.useState({name:"",description:"",parentCategory:"",module:"",displayOrder:0,isActive:!0,isFeatured:!1,metaTitle:"",metaDescription:""}),[N,ke]=g.useState([]),[m,P]=g.useState(!0),[w,x]=g.useState(null),[d,X]=g.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[Q,se]=g.useState({open:!1,message:"",severity:"success"}),[U,O]=g.useState({open:!1,categoryId:null,categoryName:""}),[ne,ie]=g.useState(null),Pe=!!ne,h=Re(),W=g.useRef(null),y=[{key:"default",label:"Default"},{key:"english",label:"English(EN)"},{key:"arabic",label:"Arabic - العربية(AR)"}],D=()=>{const t=localStorage.getItem("token")||sessionStorage.getItem("token");return console.log("Retrieved token:",t?"Token exists":"No token found"),t},we=()=>{const t=localStorage.getItem("user")||sessionStorage.getItem("user");if(!t)return console.log("No user data found in storage"),null;try{const r=JSON.parse(t);return console.log("User role:",r.role),r.role}catch(r){return console.error("Error parsing user data:",r),null}},le=()=>{const t=localStorage.getItem("user")||sessionStorage.getItem("user");if(!t)return null;try{return JSON.parse(t)._id}catch(r){return console.error("Error parsing user data:",r),null}},Se=(t,r)=>je(r),Z=g.useCallback(async()=>{const t=D();if(!t){E("You are not authenticated. Please log in."),G(!1);return}G(!0),E(null);try{const r=await fetch(`${z}/modules`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}});if(r.status===401){E("Session expired. Please log in again."),h("/login");return}if(!r.ok){const s=await r.text();throw new Error(`HTTP error! status: ${r.status}: ${s}`)}const a=await r.json();console.log("Fetched modules:",a);let o=[];Array.isArray(a)?o=a:Array.isArray(a.modules)?o=a.modules:a.data&&Array.isArray(a.data.modules)?o=a.data.modules:a.data&&Array.isArray(a.data)&&(o=a.data),ve(o);const u=window.location.pathname;let l=null;u.includes("/catering")?l=o.find(s=>(s.title||s.name||"").toLowerCase().includes("catering")):u.includes("/auditorium")&&(l=o.find(s=>(s.title||s.name||"").toLowerCase().includes("auditorium"))),l?(F(s=>({...s,module:l._id})),K(l._id)):o.length>0?(F(s=>({...s,module:o[0]._id})),K(o[0]._id)):E("No modules available. Please create a module first.")}catch(r){console.error("Error fetching modules:",r),E(r.message),p("Failed to fetch modules","error")}finally{G(!1)}},[h]),M=g.useCallback(async()=>{const t=D();if(!t){x("You are not authenticated. Please log in."),P(!1);return}P(!0),x(null);try{const r=`${z}/categories?page=${d.currentPage}&limit=${d.itemsPerPage}&search=${encodeURIComponent($)}`,a=await fetch(r,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}});if(a.status===401){x("Session expired. Please log in again."),h("/login");return}if(a.status===403){x("Access denied. You don't have permission to view categories."),h("/dashboard");return}if(!a.ok){const i=await a.text();throw new Error(`HTTP error! status: ${a.status}: ${i}`)}const o=await a.json();console.log("Fetched categories:",o);let u=[];Array.isArray(o)?u=o:Array.isArray(o.categories)?u=o.categories:o.data&&Array.isArray(o.data.categories)?u=o.data.categories:o.data&&Array.isArray(o.data)&&(u=o.data);const l=u.map(i=>{let n="";return i.image&&(i.image.startsWith("http://")||i.image.startsWith("https://")?n=i.image:i.image.startsWith("/uploads")||i.image.startsWith("uploads")?n=`https://api.bookmyevent.ae${i.image.startsWith("/")?i.image:`/${i.image}`}`:n=`https://api.bookmyevent.ae/${i.image}`),console.log("Category image processing:",{original:i.image,final:n}),{id:i._id,names:{default:i.title||i.name||"",english:i.title||i.name||"",arabic:i.title||i.name||""},status:i.isActive!==void 0?i.isActive:!0,image:n,module:i.module||null}});ke(l);const s=o.pagination||o.data&&o.data.pagination||{currentPage:d.currentPage,totalPages:Math.ceil(u.length/d.itemsPerPage),totalItems:u.length,itemsPerPage:d.itemsPerPage};X({currentPage:s.currentPage,totalPages:s.totalPages,totalItems:s.totalItems,itemsPerPage:s.itemsPerPage})}catch(r){console.error("Error fetching categories:",r),x(r.message),p(`Failed to fetch categories: ${r.message}`,"error")}finally{P(!1)}},[$,d.currentPage,d.itemsPerPage,h]);g.useEffect(()=>{const t=we(),r=D();if(console.log("Initial check - Token:",r?"Exists":"Missing","Role:",t),!r){console.log("No token found - showing error but staying on page"),x("You are not authenticated. Please log in."),P(!1);return}if(!["admin","manager","superadmin"].includes(t)){console.log("Insufficient permissions - showing error but staying on page"),x("Access denied. Admin, Manager, or Superadmin role required."),P(!1),h("/dashboard");return}Z(),M()},[Z,M,h]);const ce=(t,r)=>{F(a=>({...a,[t]:r}))},Ae=t=>{const r=t.target.files[0];if(r){if(!r.type.startsWith("image/")){p("Please select a valid image file (JPEG, PNG, GIF, WebP, SVG)","error");return}if(r.size>5*1024*1024){p("File size should be less than 5MB","error");return}J(r);const a=new FileReader;a.onload=o=>{V(o.target.result)},a.readAsDataURL(r)}},Ie=async()=>{const t=D();if(!t){x("You are not authenticated. Please log in."),h("/login");return}if(!c.name.trim()){p("Please enter a category title in Default language","error");return}if(!c.module||!/^[0-9a-fA-F]{24}$/.test(c.module)){p("Please select a valid module","error");return}P(!0);try{const r=new FormData;r.append("title",c.name.trim()),r.append("module",c.module),c.description.trim()&&r.append("description",c.description.trim()),c.parentCategory.trim()&&r.append("parentCategory",c.parentCategory.trim()),r.append("displayOrder",c.displayOrder),r.append("isActive",c.isActive),r.append("isFeatured",c.isFeatured),c.metaTitle.trim()&&r.append("metaTitle",c.metaTitle.trim()),c.metaDescription.trim()&&r.append("metaDescription",c.metaDescription.trim()),r.append("createdBy",le()),r.append("image",R),console.log("Sending FormData with module:",c.module);const a=await fetch(`${z}/categories`,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r});if(!a.ok){let l="Failed to add category";const s=a.status;try{const i=await a.text();let n;try{n=JSON.parse(i),l=n.error||l}catch{l=i||l}if(s===401){x("Session expired. Please log in again."),h("/login");return}if(s===403){x("Access denied. You don't have permission to create categories."),h("/dashboard");return}if(s===502&&(l="Server error: Unable to connect to the backend service. Please try again later."),n?.error&&n.error.includes("Unexpected file field")){p(`Image upload failed: ${n.error}. Please ensure the file is sent with the field name 'image'.`,"error");return}if(n?.error&&n.error.includes("title is required")){p("A title is required for the category.","error");return}if(n?.error&&n.error.includes("Module")){p(n.error,"error");return}}catch{l="Failed to parse server response. Please try again."}throw new Error(l)}const o=await a.json(),u=o.data?.category||o.category;p(`Category "${u.title||u.name}" added successfully!`,"success"),de(),M()}catch(r){console.error("Error adding category:",r);let a=r.message||"Failed to add category due to a network or server error. Please try again.";r.message.includes("Failed to fetch")&&(a="Network error: Unable to reach the server. Please check your connection or try again later."),p(a,"error")}finally{P(!1)}},de=()=>{F(t=>({...t,name:"",description:"",parentCategory:"",module:t.module||(A.length>0?A[0]._id:""),displayOrder:0,isActive:!0,isFeatured:!1,metaTitle:"",metaDescription:""})),J(null),V(null),W.current&&(W.current.value="")},Te=t=>{h(`/categories/edit/${t}`)},Ee=t=>{const r=N.find(a=>a.id===t);O({open:!0,categoryId:t,categoryName:r?.names?.default||""})},$e=async()=>{const t=D();if(!t){x("You are not authenticated. Please log in."),h("/login");return}P(!0);try{const r=await fetch(`${z}/categories/${U.categoryId}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(!r.ok){const a=await r.text();let o;try{o=JSON.parse(a)}catch{o={error:a||"Unknown error"}}if(r.status===401){x("Session expired. Please log in again."),h("/login");return}if(r.status===403){x("Access denied. You don't have permission to delete categories."),h("/dashboard");return}throw new Error(o.error||`HTTP error! status: ${r.status}`)}p(`Category "${U.categoryName}" deleted successfully!`,"success"),O({open:!1,categoryId:null,categoryName:""}),M()}catch(r){console.error("Error deleting category:",r),p(`Failed to delete category: ${r.message}`,"error")}finally{P(!1)}},De=async t=>{const r=D();if(!r){x("You are not authenticated. Please log in."),h("/login");return}const a=N.find(s=>s.id===t);if(!a){p("Category not found","error");return}const o=a.status,u=o?`/categories/${t}/block`:`/categories/${t}/reactivate`,l=o?"blocked":"reactivated";P(!0);try{const s=await fetch(`${z}${u}`,{method:"PATCH",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({updatedBy:le()})});if(!s.ok){const S=await s.text();let te;try{te=JSON.parse(S)}catch{te={error:S||"Unknown error"}}if(s.status===401){x("Session expired. Please log in again."),h("/login");return}if(s.status===403){x(`Access denied. You don't have permission to ${l} categories.`),h("/dashboard");return}throw new Error(te.error||`HTTP error! status: ${s.status}`)}const i=await s.json(),n=i.data?.category||i.category;p(`Category "${n.title||n.name}" ${l} successfully`,"info"),M()}catch(s){console.error(`Error ${l} category:`,s),p(`Failed to ${l} category: ${s.message}`,"error")}finally{P(!1)}},p=(t,r="success")=>{se({open:!0,message:t,severity:r})},ue=()=>{se(t=>({...t,open:!1}))},Me=()=>{h("/login")},Le=()=>{h("/dashboard")},ge=()=>{Z(),M()},B=()=>y[f].key,L=N.filter(t=>{const r=B(),a=t.names[r].toLowerCase().includes($.toLowerCase()),o=q==="all"||t.module?._id===q;return a&&o}),Ne=t=>{ie(t.currentTarget)},ee=()=>{ie(null)},We=()=>{const t=B(),a=["SI","ID",`Name (${y[f].label})`,"Module","Status"],o=L.map((n,S)=>[S+1+(d.currentPage-1)*d.itemsPerPage,n.id,n.names[t],n.module?n.module.title||"N/A":"None",n.status?"Active":"Inactive"]);let u=a.join(",")+`
`;o.forEach(n=>{u+=n.map(S=>`"${S}"`).join(",")+`
`});const l=new Blob([u],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),i=URL.createObjectURL(l);s.setAttribute("href",i),s.setAttribute("download",`categories_${t}_${new Date().toISOString().split("T")[0]}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),ee(),p("CSV file downloaded successfully!","success")},ze=()=>{const t=B(),a=["SI","ID",`Name (${y[f].label})`,"Module","Status"],o=L.map((n,S)=>[S+1+(d.currentPage-1)*d.itemsPerPage,n.id,n.names[t],n.module?n.module.title||"N/A":"None",n.status?"Active":"Inactive"]);let u=a.join("	")+`
`;o.forEach(n=>{u+=n.join("	")+`
`});const l=new Blob([u],{type:"application/vnd.ms-excel;charset=utf-8;"}),s=document.createElement("a"),i=URL.createObjectURL(l);s.setAttribute("href",i),s.setAttribute("download",`categories_${t}_${new Date().toISOString().split("T")[0]}.xls`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),ee(),p("Excel file downloaded successfully!","success")};return m&&N.length===0&&T?e.jsx(b,{sx:{p:2,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:e.jsxs(_,{alignItems:"center",spacing:2,children:[e.jsx(H,{}),e.jsx(C,{children:"Loading categories and modules..."})]})}):e.jsxs(b,{sx:{width:"100%",minHeight:"100vh",backgroundColor:"#f5f5f5",p:{xs:2,sm:3}},children:[e.jsx(he,{open:!!w||!!j,autoHideDuration:null,onClose:()=>{x(null),E(null)},children:e.jsx(me,{severity:"error",onClose:()=>{x(null),E(null)},action:e.jsxs(_,{direction:"row",spacing:1,children:[(w||j)&&(w?.includes("not authenticated")||j?.includes("not authenticated"))&&e.jsx(k,{color:"inherit",size:"small",onClick:Me,children:"Go to Login"}),(w||j)&&(w?.includes("Access denied")||j?.includes("Access denied"))&&e.jsx(k,{color:"inherit",size:"small",onClick:Le,children:"Go to Dashboard"}),(w||j)&&!(w?.includes("not authenticated")||j?.includes("not authenticated"))&&!(w?.includes("Access denied")||j?.includes("Access denied"))&&e.jsx(k,{color:"inherit",size:"small",onClick:ge,children:"Retry"})]}),children:w||j})}),e.jsx(b,{sx:{display:"flex",justifyContent:"center",mb:4},children:e.jsx(xe,{sx:{width:"100%",maxWidth:"1400px",boxShadow:3,borderRadius:3},children:e.jsxs(pe,{sx:{p:{xs:2,sm:4}},children:[e.jsx(Fe,{value:f,onChange:Se,variant:"scrollable",scrollButtons:"auto",sx:{mb:4,borderBottom:1,borderColor:"divider","& .MuiTabs-indicator":{backgroundColor:"#2196f3"}},children:y.map(t=>e.jsx(Ue,{label:t.label},t.key))}),e.jsxs(C,{variant:"subtitle1",sx:{mb:1,fontWeight:500},children:["Title (",y[f].label,") ",e.jsx("span",{style:{color:"#f44336"},children:"*"})]}),e.jsx(Y,{fullWidth:!0,value:y[f].key==="default"?c.name:"",onChange:t=>y[f].key==="default"&&ce("name",t.target.value),placeholder:`Enter category title in ${y[f].label}`,variant:"outlined",disabled:y[f].key!=="default",sx:{mb:4,"& .MuiOutlinedInput-root":{direction:y[f].key==="arabic"?"rtl":"ltr"}}}),e.jsxs(C,{variant:"subtitle1",sx:{mb:1,fontWeight:500},children:["Module ",e.jsx("span",{style:{color:"#f44336"},children:"*"})]}),e.jsx(Y,{select:!0,fullWidth:!0,value:c.module,onChange:t=>ce("module",t.target.value),placeholder:"Select a module",variant:"outlined",disabled:T||j||A.length===0,sx:{mb:4,"& .MuiOutlinedInput-root":{backgroundColor:T||j||A.length===0?"#f5f5f5":"white"}},children:T?e.jsx(I,{value:"",children:"Loading modules..."}):j?e.jsx(I,{value:"",children:"Error loading modules"}):A.length===0?e.jsx(I,{value:"",children:"No modules available"}):A.map(t=>e.jsx(I,{value:t._id,children:t.title||t.name||"Unnamed Module"},t._id))}),e.jsxs(C,{variant:"subtitle1",sx:{mb:1,fontWeight:500},children:["Image ",e.jsx("span",{style:{color:"#f44336"},children:"*"})," ",e.jsx("span",{style:{color:"#e91e63",fontSize:"0.875rem"},children:"(Ratio 3:2)"})]}),e.jsxs(b,{sx:{display:"flex",gap:3,mb:4,flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(b,{children:[e.jsx("input",{id:"image-upload-input",type:"file",accept:"image/*",onChange:Ae,ref:W,style:{display:"none"}}),e.jsx("label",{htmlFor:"image-upload-input",children:e.jsxs(k,{component:"span",variant:"outlined",sx:{width:{xs:"100%",sm:240},height:{xs:100,sm:140},border:"2px dashed #e0e0e0",borderRadius:2,display:"flex",flexDirection:"column",gap:1,color:"text.secondary",textTransform:"none","&:hover":{borderColor:"#2196f3",backgroundColor:"#e3f2fd",border:"2px dashed #2196f3"}},children:[e.jsx(at,{sx:{fontSize:40,color:"#bdbdbd"}}),e.jsx(C,{variant:"body2",color:"text.secondary",children:R?"Change Image":"Upload Image"})]})})]}),oe&&e.jsxs(b,{sx:{position:"relative"},children:[e.jsxs(b,{sx:{width:{xs:"100%",sm:240},height:{xs:160,sm:140},border:"2px solid #e0e0e0",borderRadius:2,overflow:"hidden",position:"relative"},children:[e.jsx("img",{src:oe,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx(re,{size:"small",onClick:()=>{V(null),J(null),W.current&&(W.current.value="")},sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(0,0,0,0.5)",color:"white","&:hover":{backgroundColor:"rgba(0,0,0,0.7)"}},children:e.jsx(Oe,{fontSize:"small"})})]}),e.jsx(C,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:R?.name})]})]}),e.jsxs(b,{sx:{display:"flex",flexWrap:"wrap",justifyContent:{xs:"center",sm:"flex-end"},gap:2},children:[e.jsx(k,{variant:"outlined",onClick:de,sx:{px:4,py:1.5,textTransform:"none",borderColor:"#e0e0e0",color:"#666","&:hover":{borderColor:"#bdbdbd",backgroundColor:"#f5f5f5"}},disabled:m||T,children:"Reset"}),e.jsx(k,{variant:"contained",onClick:Ie,disabled:!c.name.trim()||!c.module||!/^[0-9a-fA-F]{24}$/.test(c.module)||!R||m||T||j||A.length===0,sx:{px:4,py:1.5,backgroundColor:"#00695c",textTransform:"none","&:hover":{backgroundColor:"#004d40"},"&:disabled":{backgroundColor:"#e0e0e0",color:"#999"}},children:m?e.jsx(H,{size:20,color:"inherit"}):"Add"})]})]})})}),e.jsx(b,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(xe,{sx:{width:"100%",maxWidth:"1400px",boxShadow:3,borderRadius:3},children:e.jsxs(pe,{sx:{p:{xs:2,sm:3}},children:[e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:2,mb:3},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(C,{variant:"h6",fontWeight:600,children:"Category List"}),e.jsx(fe,{label:L.length,size:"small",sx:{backgroundColor:"#e3f2fd",color:"#2196f3",fontWeight:600}}),e.jsx(fe,{label:`Language: ${y[f].label}`,size:"small",sx:{backgroundColor:"#e8f5e8",color:"#2e7d32",fontWeight:500}})]}),e.jsxs(b,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[e.jsxs(Y,{select:!0,size:"small",value:q,onChange:t=>K(t.target.value),sx:{minWidth:{xs:"100%",sm:200}},disabled:m||T,children:[e.jsx(I,{value:"all",children:"All Modules"}),A.map(t=>e.jsx(I,{value:t._id,children:t.title||t.name||"Unnamed Module"},t._id))]}),e.jsx(Y,{size:"small",placeholder:`Search categories in ${y[f].label}`,value:$,onChange:t=>Ce(t.target.value),sx:{minWidth:{xs:"100%",sm:250,md:300},"& .MuiOutlinedInput-root":{direction:y[f].key==="arabic"?"rtl":"ltr"}},InputProps:{startAdornment:e.jsx(Be,{position:"start",children:e.jsx(ot,{sx:{color:"#bdbdbd"}})})},disabled:m}),e.jsx(k,{variant:"outlined",startIcon:e.jsx(nt,{}),endIcon:e.jsx(st,{}),onClick:Ne,sx:{textTransform:"none",borderColor:"#e0e0e0",color:"#2196f3","&:hover":{borderColor:"#2196f3",backgroundColor:"#e3f2fd"}},disabled:m||L.length===0,children:"Export"}),e.jsxs(_e,{anchorEl:ne,open:Pe,onClose:ee,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPaper-root":{minWidth:180,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",borderRadius:2,mt:1}},children:[e.jsxs(I,{onClick:ze,sx:{py:1.5,px:2},children:[e.jsx(ye,{children:e.jsx(it,{sx:{color:"#1976d2"}})}),e.jsx(be,{primary:"Export to Excel",primaryTypographyProps:{fontWeight:500}})]}),e.jsx(He,{}),e.jsxs(I,{onClick:We,sx:{py:1.5,px:2},children:[e.jsx(ye,{children:e.jsx(lt,{sx:{color:"#2e7d32"}})}),e.jsx(be,{primary:"Export to CSV",primaryTypographyProps:{fontWeight:500}})]})]})]})]}),m&&N.length>0&&e.jsx(b,{display:"flex",justifyContent:"center",p:2,children:e.jsx(H,{size:24})}),e.jsx(Ye,{component:Je,sx:{overflowX:"auto"},children:e.jsxs(Ve,{size:"small",children:[e.jsx(Ge,{sx:{backgroundColor:"#fafafa"},children:e.jsxs(ae,{children:[e.jsx(v,{sx:{fontWeight:600,color:"#666"},children:"SI"}),e.jsx(v,{sx:{fontWeight:600,color:"#666"},children:"Image"}),e.jsxs(v,{sx:{fontWeight:600,color:"#666",direction:y[f].key==="arabic"?"rtl":"ltr"},children:["Name (",y[f].label,")"]}),e.jsx(v,{sx:{fontWeight:600,color:"#666"},children:"Module"}),e.jsx(v,{sx:{fontWeight:600,color:"#666"},children:"Status"}),e.jsx(v,{sx:{fontWeight:600,color:"#666"},children:"Action"})]})}),e.jsx(qe,{children:L.length>0?L.map((t,r)=>{const a=B();return e.jsxs(ae,{sx:{"&:hover":{backgroundColor:"#f9f9f9"}},children:[e.jsx(v,{children:r+1+(d.currentPage-1)*d.itemsPerPage}),e.jsx(v,{children:t.image?e.jsx(b,{sx:{width:50,height:35,borderRadius:1,overflow:"hidden",border:"1px solid #e0e0e0"},children:e.jsx("img",{src:t.image,alt:t.names[a],style:{width:"100%",height:"100%",objectFit:"cover"},onError:o=>{console.error("Image failed to load:",t.image),o.target.style.display="none",o.target.parentElement.innerHTML='<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#f5f5f5;font-size:10px;color:#999;">Error</div>'}})}):e.jsx(b,{sx:{width:50,height:35,borderRadius:1,backgroundColor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #e0e0e0"},children:e.jsx(C,{variant:"caption",color:"text.secondary",children:"No Image"})})}),e.jsx(v,{sx:{fontWeight:500,maxWidth:200,direction:y[f].key==="arabic"?"rtl":"ltr"},children:e.jsx(C,{variant:"body2",sx:{wordBreak:"break-word"},children:t.names[a]})}),e.jsx(v,{children:e.jsx(C,{variant:"body2",children:t.module?t.module.title||"N/A":"None"})}),e.jsx(v,{children:e.jsx(Ke,{checked:t.status,onChange:()=>De(t.id),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#2196f3"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#2196f3"}},disabled:m})}),e.jsx(v,{children:e.jsxs(b,{sx:{display:"flex",gap:1},children:[e.jsx(re,{size:"small",onClick:()=>Te(t.id),sx:{color:"#2196f3"},disabled:m,children:e.jsx(Xe,{fontSize:"small"})}),e.jsx(re,{size:"small",onClick:()=>Ee(t.id),sx:{color:"#f44336"},disabled:m,children:e.jsx(Qe,{fontSize:"small"})})]})})]},t.id)}):e.jsx(ae,{children:e.jsx(v,{colSpan:6,sx:{textAlign:"center",py:4,color:"#999"},children:e.jsxs(_,{spacing:2,alignItems:"center",children:[e.jsx(C,{variant:"h6",color:"textSecondary",children:m?"Loading categories...":$?`No categories found matching your search in ${y[f].label}.`:"No categories available."}),w||j?e.jsx(k,{variant:"outlined",onClick:ge,children:"Try Again"}):!m&&!$&&e.jsx(C,{variant:"body2",color:"textSecondary",children:"Create your first category using the form above"})]})})})})]})}),d.totalPages>1&&e.jsxs(_,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",p:2,children:[e.jsx(k,{variant:"outlined",disabled:d.currentPage===1||m,onClick:()=>X(t=>({...t,currentPage:t.currentPage-1})),children:"Previous"}),e.jsxs(C,{variant:"body2",children:["Page ",d.currentPage," of ",d.totalPages,d.totalItems?` (${d.totalItems} total)`:""]}),e.jsx(k,{variant:"outlined",disabled:d.currentPage===d.totalPages||m,onClick:()=>X(t=>({...t,currentPage:t.currentPage+1})),children:"Next"})]})]})})}),e.jsxs(Ze,{open:U.open,onClose:()=>O({open:!1,categoryId:null,categoryName:""}),maxWidth:"sm",fullWidth:!0,children:[e.jsx(et,{sx:{fontWeight:600},children:"Confirm Delete"}),e.jsx(tt,{children:e.jsxs(C,{children:['Are you sure you want to delete the category "',U.categoryName,'"? This action cannot be undone.']})}),e.jsxs(rt,{sx:{p:3,gap:1},children:[e.jsx(k,{onClick:()=>O({open:!1,categoryId:null,categoryName:""}),variant:"outlined",sx:{textTransform:"none"},disabled:m,children:"Cancel"}),e.jsx(k,{onClick:$e,variant:"contained",color:"error",sx:{textTransform:"none"},disabled:m,children:m?e.jsx(H,{size:20,color:"inherit"}):"Delete"})]})]}),e.jsx(he,{open:Q.open,autoHideDuration:4e3,onClose:ue,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(me,{onClose:ue,severity:Q.severity,variant:"filled",sx:{width:"100%"},children:Q.message})})]})}export{pt as default};
